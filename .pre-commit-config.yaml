# ğŸ”’ CONFIGURAÃ‡ÃƒO DE PRE-COMMIT HOOKS - TASKORA
# Sistema de detecÃ§Ã£o de segredos e validaÃ§Ã£o de seguranÃ§a

repos:
  # DetecÃ§Ã£o de segredos e chaves API
  - repo: https://github.com/Yelp/detect-secrets
    rev: v1.4.0
    hooks:
      - id: detect-secrets
        name: ğŸ” Detectar Segredos
        description: Detecta chaves API, senhas e outros segredos
        args: 
          - '--baseline'
          - '.secrets.baseline'
          - '--force-use-all-plugins'
        exclude: |
          (?x)^(
            package-lock\.json|
            yarn\.lock|
            \.env\.example|
            docs/.*\.md
          )$

  # VerificaÃ§Ãµes gerais de seguranÃ§a
  - repo: https://github.com/pre-commit/pre-commit-hooks
    rev: v4.4.0
    hooks:
      - id: check-added-large-files
        name: ğŸ“ Verificar Arquivos Grandes
        description: Previne commit de arquivos muito grandes
        args: ['--maxkb=1000']
      
      - id: check-merge-conflict
        name: âš”ï¸ Verificar Conflitos de Merge
        description: Detecta marcadores de conflito de merge
      
      - id: check-yaml
        name: ğŸ“„ Validar YAML
        description: Valida sintaxe de arquivos YAML
      
      - id: check-json
        name: ğŸ“„ Validar JSON
        description: Valida sintaxe de arquivos JSON
        exclude: |
          (?x)^(
            package-lock\.json|
            \.vscode/.*
          )$
      
      - id: trailing-whitespace
        name: ğŸ§¹ Remover EspaÃ§os em Branco
        description: Remove espaÃ§os em branco no final das linhas
      
      - id: end-of-file-fixer
        name: ğŸ“ Corrigir Final de Arquivo
        description: Garante que arquivos terminem com nova linha

  # VerificaÃ§Ãµes especÃ­ficas para JavaScript/HTML
  - repo: https://github.com/pre-commit/mirrors-eslint
    rev: v8.57.0
    hooks:
      - id: eslint
        name: ğŸ” ESLint - JavaScript
        description: Analisa cÃ³digo JavaScript para problemas de seguranÃ§a
        files: \.(js|jsx|ts|tsx)$
        additional_dependencies:
          - eslint@8.57.0
          - eslint-plugin-security@1.7.1
        args:
          - --fix
          - --config
          - .eslintrc.security.js

  # VerificaÃ§Ã£o de dependÃªncias vulnerÃ¡veis
  - repo: https://github.com/Lucas-C/pre-commit-hooks-safety
    rev: v1.3.2
    hooks:
      - id: python-safety-dependencies-check
        name: ğŸ›¡ï¸ Verificar DependÃªncias Python
        description: Verifica vulnerabilidades em dependÃªncias Python
        files: requirements.*\.txt$

  # VerificaÃ§Ãµes customizadas para Firebase
  - repo: local
    hooks:
      - id: check-firebase-keys
        name: ğŸ”¥ Verificar Chaves Firebase
        description: Detecta chaves Firebase hardcoded
        entry: bash -c 'if grep -r "AIzaSy[A-Za-z0-9_-]\{33\}" --exclude-dir=node_modules --exclude=".env.example" .; then echo "âŒ ERRO: Chave Firebase detectada!"; exit 1; fi'
        language: system
        pass_filenames: false
        always_run: true
      
      - id: check-env-files
        name: ğŸ“ Verificar Arquivos .env
        description: Previne commit de arquivos .env
        entry: bash -c 'if find . -name ".env" -not -path "./node_modules/*" | grep -q .; then echo "âŒ ERRO: Arquivo .env detectado! Use .env.example"; exit 1; fi'
        language: system
        pass_filenames: false
        always_run: true
      
      - id: check-backup-files
        name: ğŸ’¾ Verificar Arquivos de Backup
        description: Detecta arquivos de backup com dados sensÃ­veis
        entry: bash -c 'if find . -name "*backup*.json" -o -name "*backup*.sql" | grep -q .; then echo "âŒ ERRO: Arquivo de backup detectado!"; exit 1; fi'
        language: system
        pass_filenames: false
        always_run: true
      
      - id: check-debug-files
        name: ğŸ› Verificar Arquivos de Debug
        description: Detecta arquivos de debug temporÃ¡rios
        entry: bash -c 'if find . -name "debug*.html" -o -name "test*.html" -o -name "temp*.html" | grep -q .; then echo "âš ï¸ AVISO: Arquivo de debug detectado! Verifique se nÃ£o contÃ©m dados sensÃ­veis"; fi'
        language: system
        pass_filenames: false
        always_run: true

# ConfiguraÃ§Ã£o global
default_stages: [commit, push]
fail_fast: true

# ConfiguraÃ§Ãµes especÃ­ficas
ci:
  autofix_commit_msg: |
    ğŸ”§ [pre-commit.ci] auto fixes from pre-commit hooks
    
    for more information, see https://pre-commit.ci
  autofix_prs: true
  autoupdate_branch: ''
  autoupdate_commit_msg: 'ğŸ”„ [pre-commit.ci] pre-commit autoupdate'
  autoupdate_schedule: weekly
  skip: []
  submodules: false
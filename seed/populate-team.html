<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Popular Cole√ß√£o Team - Taskora</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 50px auto; padding: 20px; }
        .container { background: #f5f5f5; padding: 20px; border-radius: 8px; }
        button { background: #014029; color: white; padding: 10px 20px; border: none; border-radius: 4px; cursor: pointer; margin: 5px; }
        button:hover { background: #022d1f; }
        button:disabled { background: #ccc; cursor: not-allowed; }
        .log { background: white; padding: 15px; border-radius: 4px; margin-top: 20px; max-height: 400px; overflow-y: auto; font-family: monospace; font-size: 12px; }
        .success { color: #014029; }
        .error { color: #dc3545; }
        .warning { color: #856404; }
        .info { color: #0c5460; }
    </style>
</head>
<body>
    <div class="container">
        <h1>üöÄ Popular Cole√ß√£o Team no Firebase</h1>
        <p>Este script ir√° criar a cole√ß√£o 'team' no Firebase com dados de exemplo.</p>
        <p><strong>‚ö†Ô∏è Importante:</strong> Execute apenas uma vez para evitar duplicatas.</p>
        
        <button id="populateBtn" onclick="populateTeam()">Criar Membros da Equipe</button>
        <button onclick="clearLog()">Limpar Log</button>
        
        <div id="log" class="log">
            <p>Clique em "Criar Membros da Equipe" para come√ßar...</p>
        </div>
    </div>

    <script>
        // Configura√ß√£o do Firebase (mesma do projeto)
        const firebaseConfig = {
            apiKey: "AIzaSyBEWmvJT9PoSuC17QqOmNHZ-dqcQOmOmHZ",
            authDomain: "taskora-dacora.firebaseapp.com",
            projectId: "taskora-dacora",
            storageBucket: "taskora-dacora.firebasestorage.app",
            messagingSenderId: "798584108634",
            appId: "1:798584108634:web:f8e6c1b7c17c7b5a6e4f2d"
        };

        let firebaseApp = null;
        let db = null;

        function log(message, type = 'info') {
            const logDiv = document.getElementById('log');
            const timestamp = new Date().toLocaleTimeString();
            const className = type;
            logDiv.innerHTML += `<p class="${className}">[${timestamp}] ${message}</p>`;
            logDiv.scrollTop = logDiv.scrollHeight;
        }

        function clearLog() {
            document.getElementById('log').innerHTML = '<p>Log limpo...</p>';
        }

        async function initFirebase() {
            if (firebaseApp && db) return { app: firebaseApp, db };
            
            try {
                log('üîß Inicializando Firebase...', 'info');
                
                // Importar Firebase de forma mais simples
                const { initializeApp } = await import('https://www.gstatic.com/firebasejs/10.12.5/firebase-app.js');
                const { getFirestore, connectFirestoreEmulator } = await import('https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js');
                
                firebaseApp = initializeApp(firebaseConfig);
                db = getFirestore(firebaseApp);
                
                log('‚úÖ Firebase inicializado com sucesso', 'success');
                return { app: firebaseApp, db };
                
            } catch (error) {
                log(`‚ùå Erro ao inicializar Firebase: ${error.message}`, 'error');
                throw error;
            }
        }

        async function populateTeam() {
            const btn = document.getElementById('populateBtn');
            btn.disabled = true;
            btn.textContent = 'Criando...';
            
            try {
                log('üöÄ Iniciando popula√ß√£o da cole√ß√£o team...', 'info');
                
                // Inicializar Firebase
                const { db: database } = await initFirebase();
                
                // Importar apenas as fun√ß√µes essenciais
                const { 
                    collection, 
                    addDoc, 
                    serverTimestamp
                } = await import('https://www.gstatic.com/firebasejs/10.12.5/firebase-firestore.js');
                
                log('üìù Preparando dados dos membros...', 'info');
                
                // Dados dos membros de exemplo
                const teamMembers = [
                    {
                        name: 'Ana Silva',
                        email: 'ana@dacora.com.br',
                        phone: '(11) 99999-9999',
                        specialty: ['Marketing', 'Estrat√©gia'],
                        level: 'S√™nior',
                        status: 'Ativo',
                        notes: 'Especialista em estrat√©gia digital e marketing de conte√∫do',
                        totalHours: 0,
                        totalTasks: 0,
                        averageRating: 0
                    },
                    {
                        name: 'Carlos Santos',
                        email: 'carlos@dacora.com.br',
                        phone: '(11) 88888-8888',
                        specialty: ['Desenvolvimento'],
                        level: 'Pleno',
                        status: 'Ativo',
                        notes: 'Full-stack developer especializado em React e Node.js',
                        totalHours: 0,
                        totalTasks: 0,
                        averageRating: 0
                    },
                    {
                        name: 'Maria Costa',
                        email: 'maria@dacora.com.br',
                        phone: '(11) 77777-7777',
                        specialty: ['Gestor de Tr√°fego'],
                        level: 'Lead',
                        status: 'Ativo',
                        notes: 'Especialista em tr√°fego pago Google Ads e Facebook Ads',
                        totalHours: 0,
                        totalTasks: 0,
                        averageRating: 0
                    },
                    {
                        name: 'Jo√£o Oliveira',
                        email: 'joao@dacora.com.br',
                        phone: '(11) 66666-6666',
                        specialty: ['Copywriting', 'Social Media'],
                        level: 'Pleno',
                        status: 'Ativo',
                        notes: 'Copywriter e social media manager',
                        totalHours: 0,
                        totalTasks: 0,
                        averageRating: 0
                    },
                    {
                        name: 'Fernanda Lima',
                        email: 'fernanda@dacora.com.br',
                        phone: '(11) 55555-5555',
                        specialty: ['SEO/SEM', 'Gest√£o de Projetos'],
                        level: 'S√™nior',
                        status: 'Ativo',
                        notes: 'Especialista em SEO e gest√£o de projetos digitais',
                        totalHours: 0,
                        totalTasks: 0,
                        averageRating: 0
                    }
                ];

                log(`üìù Criando ${teamMembers.length} membros da equipe...`, 'info');

                let createdCount = 0;
                let errorCount = 0;

                // Criar cada membro (sem verifica√ß√£o de duplicata para simplicidade)
                for (let i = 0; i < teamMembers.length; i++) {
                    const member = teamMembers[i];
                    
                    try {
                        log(`‚è≥ Criando: ${member.name}...`, 'info');
                        
                        const memberData = {
                            ...member,
                            createdAt: serverTimestamp(),
                            updatedAt: serverTimestamp()
                        };

                        const docRef = await addDoc(collection(database, 'team'), memberData);
                        log(`‚úÖ ${member.name} criado com sucesso (ID: ${docRef.id})`, 'success');
                        createdCount++;
                        
                        // Pausa entre cria√ß√µes
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        
                    } catch (error) {
                        log(`‚ùå Erro ao criar ${member.name}: ${error.message}`, 'error');
                        errorCount++;
                        console.error('Erro detalhado:', error);
                    }
                }

                log(`üéâ Popula√ß√£o conclu√≠da!`, 'success');
                log(`üìä Resultado: ${createdCount} criados, ${errorCount} erros`, 'info');
                
                if (createdCount > 0) {
                    log('üîÑ Agora voc√™ pode testar a integra√ß√£o Team ‚Üî Tasks!', 'success');
                    log('üí° Dica: Recarregue a p√°gina do Taskora para ver os novos membros.', 'info');
                    log('üéØ V√° para: Tarefas > Nova Tarefa > Campo Respons√°vel', 'info');
                }
                
            } catch (error) {
                log(`‚ùå Erro geral: ${error.message}`, 'error');
                console.error('Erro completo:', error);
            } finally {
                btn.disabled = false;
                btn.textContent = 'Criar Membros da Equipe';
            }
        }
    </script>
</body>
</html>